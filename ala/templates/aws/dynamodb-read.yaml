
resources:
  dynamoDbReadPolicy:
    type: aws:iam:Policy
    properties:
      description: attach reading dynamoDB
      policy: ${dynamoDbReadPolicyDocument.json}
  dynamoDbReadPolicyAttach:
    type: aws:iam:PolicyAttachment
    properties:
      roles:
        - %{fn.role}  # 获取调用方的Role
      policyArn: ${dynamoDbReadPolicy.arn}

variables:
  dynamoDbReadPolicyDocument:
    fn::invoke:
      function: aws:iam:getPolicyDocument
      arguments:
        statements:
          - effect: Allow
            actions:
              - dynamodb:GetItem
              - dynamodb:BatchGetItem
            resources:
              - '*' #TODO: 修改成相应的资源