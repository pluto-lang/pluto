resources:
  dynamoDbWritePolicy:
    type: aws:iam:Policy
    properties:
      description: attach Writting dynamoDB
      policy: ${dynamoDbWritePolicyDocument.json}
  dynamoDbWritePolicyAttach:
    type: aws:iam:PolicyAttachment
    properties:
      roles:
        - %{fn.role}  # 获取调用方的Role
      policyArn: ${dynamoDbWritePolicy.arn}

variables:
  dynamoDbWritePolicyDocument:
    fn::invoke:
      function: aws:iam:getPolicyDocument
      arguments:
        statements:
          - effect: Allow
            actions:
              - dynamodb:*
            resources:
              - '*' #TODO: 修改成相应的资源